<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <script src="Scripts/jquery-2.1.3.min.js"></script>
    <script src="Scripts/knockout-3.2.0.debug.js"></script>
    <!--<script src="Scripts/bootstrap.min.js"></script>-->
    <script src="Scripts/bootstrap.js"></script>
    <script src="Scripts/Project/data.js"></script>
    <link href="Content/bootstrap.min.css" rel="stylesheet" />
    <link href="Content/bootstrap-theme.min.css" rel="stylesheet" />
    
    <script>
        $(function () {

            // Group construction, constructor function
            var Group = function () {
                this.groupId = ko.observable();
                this.groupName = ko.observable();
                this.disableMe = ko.observable();
                //this.photoUrl = ko.computed(function () {
                //    return photoPath + this.photo();
                //}, this);
            };

            my.vm = {
                groups: ko.observableArray([]),
                selectedGroups: ko.observableArray([]),
                groupToAdd: ko.observable(""),

                load: function () {
                    $.each(my.sampleData.data.Groups, function (i, p) {
                        my.vm.groups.push(new Group()
                            .groupId(p.Id)
                            .groupName(p.GroupName)
                            .disableMe(p.Disable)
                            );
                    });
                },
                htmlSampler: ko.observable("<strong><em>knockout rocks</em></strong>"),

                selectedColorForGroup: ko.observable(),
                colors: [{ key: "BR", name: "Brown" },
                    { key: "BL", name: "Blue" },
                    { key: "BK", name: "Black" },
                ]
            };
            //remove..
            my.vm.groupsAreSelected = ko.computed(function () {
                return my.vm.selectedGroups().length > 0;
            });

            my.vm.removeSelected = function () {
                my.vm.groups.removeAll(my.vm.selectedGroups());
                my.vm.selectedGroups([]);
            };
            //add..
            my.vm.addGroup = function () {
                alert(my.vm.groupToAdd());
                if (my.vm.groupToAdd() === "")
                    return;
                my.vm.groups.push(new Group().groupName(my.vm.groupToAdd()));
            };

            my.vm.groupHasBeenEntered = ko.computed(function() {
                return my.vm.groupToAdd().length > 0;
            });

            //sorting..
            my.vm.groupExists = ko.computed(function () {
                return my.vm.groups().length > 0;
            });

            my.vm.sortGroups = function(){
                my.vm.groups.sort(
                    function (left, right) {
                        return left.groupName().toLowerCase() === right.groupName().toLowerCase()
                        ? 0 : (left.groupName().toLowerCase() < right.groupName().toLowerCase() ? -1 : 1);
                    }
                    );
            };



            my.vm.load();
            ko.applyBindings(my.vm);
        });
    </script>

</head>
<body>

    <span data-bind="text:groups().length"></span>

    <select class="groupsSelect" multiple="multiple"
            data-bind="options: groups, selectedOptions:selectedGroups, optionsText: 'groupName'"></select>

    <button data-bind="click: removeSelected, enable:groupsAreSelected ">Remove</button>

    <!--<input type="text" data-bind="value:groupToAdd, valueUpdate:'afterkeydown'" />
    <button data-bind="click:addGroup, enable: groupHasBeenEntered">Add</button>-->

    <form data-bind="submit: addGroup">
        <input type="text" data-bind="value:groupToAdd, valueUpdate:'afterkeydown'"/>
        <button type="submit" data-bind="enable: groupHasBeenEntered">Add</button>
    </form>

    <button data-bind="click:sortGroups, enable: groupExists">Sort</button>

    <table class="table-bordered table-striped">

        <thead>
            <tr>
                <th>target value</th>
                <th>source</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><span data-bind="text:htmlSampler"></span>></td>
                <td><span data-bind="html:htmlSampler"></span></td>
            </tr>
        </tbody>
    </table>

    <div class="caption">checked and value</div>
    <div class="notes">radio buttons</div>

    <input type="radio" value="BR" data-bind="checked:selectedColorForGroup"/><span>brown</span>
    <input type="radio" value="BL" data-bind="checked:selectedColorForGroup" /><span>blue</span>
    <input type="radio" value="BK" data-bind="checked:selectedColorForGroup" /><span>black</span>
    <br/>
    <span>selectedColorForGroup:</span><span data-bind="text: selectedColorForGroup "></span>

    <!--use array-->
    <div class="caption">checked and value</div>
    <div class="notes">radio buttons (foreach)</div>
    <div data-bind="foreach: colors">
        <input type="radio" data-bind=" checked: $parent.selectedColorForGroup, value: key " /><span data-bind="text: name">black</span>

    </div>
    <br />
    <span>selectedColorForGroup:</span><span data-bind="text: selectedColorForGroup "></span>



</body>
</html>
